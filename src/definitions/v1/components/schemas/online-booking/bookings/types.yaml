components:
  schemas:
    # Core Booking Types
    bookingStatus:
      type: string
      enum: [pending, confirmed, cancelled, completed]
      example: "confirmed"
      description: Current status of the booking

    bookingType:
      type: string
      enum: [standard, flexible, long_term]
      example: "standard"
      description: Type of booking arrangement

    # Booking Value Objects
    bookingDates:
      type: object
      properties:
        checkIn:
          $ref: '../common/types.yaml#/components/schemas/date'
          description: Check-in date for the booking
        checkOut:
          $ref: '../common/types.yaml#/components/schemas/date'
          description: Check-out date for the booking
        nights:
          type: integer
          minimum: 1
          description: Number of nights for the booking
          example: 5
      required:
        - checkIn
        - checkOut

    bookingGuests:
      type: object
      properties:
        adults:
          type: integer
          minimum: 1
          maximum: 10
          description: Number of adult guests
          example: 2
        children:
          type: integer
          minimum: 0
          maximum: 10
          description: Number of child guests
          example: 1
        infants:
          type: integer
          minimum: 0
          maximum: 5
          description: Number of infant guests (under 2 years)
          example: 0
        pets:
          type: integer
          minimum: 0
          maximum: 3
          description: Number of pets
          example: 0
      required:
        - adults

    guestContact:
      type: object
      properties:
        name:
          type: string
          minLength: 2
          maxLength: 100
          description: Full name of the primary guest
          example: "John Doe"
        email:
          $ref: '../common/types.yaml#/components/schemas/email'
        phone:
          $ref: '../common/types.yaml#/components/schemas/phone'
        address:
          $ref: '../common/types.yaml#/components/schemas/address'
      required:
        - name
        - email

    bookingPrice:
      allOf:
        - $ref: '../common/types.yaml#/components/schemas/money'
        - type: object
          properties:
            breakdown:
              type: object
              properties:
                basePrice:
                  $ref: '../common/types.yaml#/components/schemas/money'
                taxes:
                  $ref: '../common/types.yaml#/components/schemas/money'
                fees:
                  type: array
                  items:
                    type: object
                    properties:
                      name:
                        type: string
                        example: "Cleaning Fee"
                      amount:
                        $ref: '../common/types.yaml#/components/schemas/money'
                    required:
                      - name
                      - amount
              required:
                - basePrice

    bookingCancellation:
      type: object
      properties:
        cancelledAt:
          $ref: '../common/types.yaml#/components/schemas/timestamp'
        reason:
          type: string
          maxLength: 500
          example: "Change in travel plans"
        refundAmount:
          $ref: '../common/types.yaml#/components/schemas/money'
        cancelledBy:
          $ref: '../common/types.yaml#/components/schemas/uuid'
      required:
        - cancelledAt
        - cancelledBy

    # Booking Aggregate
    booking:
      type: object
      properties:
        id:
          $ref: '../common/types.yaml#/components/schemas/uuid'
        propertyId:
          $ref: '../common/types.yaml#/components/schemas/uuid'
        status:
          $ref: '#/components/schemas/bookingStatus'
        type:
          $ref: '#/components/schemas/bookingType'
        dates:
          $ref: '#/components/schemas/bookingDates'
        guests:
          $ref: '#/components/schemas/bookingGuests'
        contact:
          $ref: '#/components/schemas/guestContact'
        price:
          $ref: '#/components/schemas/bookingPrice'
        cancellation:
          $ref: '#/components/schemas/bookingCancellation'
        metadata:
          $ref: '../common/types.yaml#/components/schemas/metadata'
        audit:
          $ref: '../common/types.yaml#/components/schemas/auditInfo'
      required:
        - id
        - propertyId
        - status
        - type
        - dates
        - guests
        - contact
        - price
        - audit 